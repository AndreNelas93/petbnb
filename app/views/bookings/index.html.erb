<div class="container">
  <div class="container text-center my-5">
    <h3>Your dashboard</h3>
  </div>
  <hr>
  <div class="card-grid">
    <div>
      <div class="text-center my-3">
        <h3>Your info</h3>
      </div>
      <div class="card">
        <%= image_tag "dog.png", class:"card-img-top" %>
        <div class="card-body">
          <h5 class="card-title"><%= current_user.email %></h5>
          <p class="card-text"><%= "Total listings: #{@listings.size}" %></p>
          <p class="card-text"><%= "Total bookings: #{@bookings.size}" %></p>
          <%= link_to "Edit", edit_user_registration_path(current_user), class:"btn btn-sm btn-outline-primary" %>
        </div>
      </div>
    </div>

    <div>
      <div class="text-center my-3">
        <h3>Your listings</h3>
      </div>
      <% @listings.each do |listing| %>
      <div class="card-product mb-2">
        <%= image_tag "dog.png", class:"card-img-top" %>
        <div class="card-product-infos mx-3">
          <h2><%= listing.title %></h2>
          <p><%= listing.description %></p>
          <p><%= "#{listing.price_per_night}$/night" %></p>
          <p><%= link_to "See listing", new_listing_booking_path(listing) %></p>
        </div>
      </div>
      <% end %>
    </div>


    <div>
      <div class="text-center my-3">
        <h3>Your bookings</h3>
      </div>
      <div class="list-group">
        <% @bookings.each do |booking| %>
        <% listing = Listing.find(booking.listing_id) %>
        <% start_date = booking.start_date.strftime("%d/%b") %>
        <% end_date = booking.start_date.strftime("%d/%b/%y") %>
        <li class="list-group-item">
            <div class="row d-flex justify-content-between mt-2">
              <div class="col">
                <p style="font-weight: bold;"><%= listing.title %></p>
              </div>
              <div class="col">
                <%= " for #{booking.num_of_pets} #{booking.pet_type}(s)" %>
              </div>
            </div>
            <div class="row d-flex justify-content-between my-1">
              <div class="col">
                <%= "#{booking.total_price}$" %>
              </div>
              <div class="col">
                <%= "(#{start_date} to #{end_date})" %>
              </div>
            </div>
        </li>
        <% end %>
      </div>
    </div>
  </div>
</div>
